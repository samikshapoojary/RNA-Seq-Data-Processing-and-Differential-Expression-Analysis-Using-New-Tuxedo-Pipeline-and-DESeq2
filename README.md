# RNA-Seq-Data-Processing-and-Differential-Expression-Analysis-Using-New-Tuxedo-Pipeline-and-DESeq2
Bash and R pipeline for RNA-Seq data processing and differential expression analysis using the New Tuxedo suite and DESeq2. Developed as coursework for MSc Bioinformatics 2024/25, University of Glasgow.


## Overview

This project implements a complete RNA-Seq differential expression analysis pipeline split into two main components:

1. **Preprocessing and count matrix generation (Bash pipeline)**
2. **Differential expression analysis and visualization (R pipeline)**

The pipeline is designed to process raw single-end RNA-Seq data from FASTQ files to biologically meaningful differential gene expression results using HPC resources and standard bioinformatics tools.

---

## Contents

| Filename      | Description                                                                                                                                                                                                                                                                           |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `newtuxedo_pipeline.sh` | Bash script to preprocess raw FASTQ files, perform quality trimming, alignment, assembly, and generate gene and transcript count matrices. Utilizes tools such as scythe, sickle, HISAT2, samtools, stringtie, and prepDE.py. Designed to be executed as a single HPC job submission. |
| `deseq2_analysis.R`    | R script implementing differential expression analysis using DESeq2. Performs data import, filtering, normalization, batch correction, and visualization. Generates results including dispersion plots, PCA, MA plots, and significant gene lists exported as CSV files.              |

---

## Detailed Description

### 1. Bash Script (`newtuxedo_pipeline.sh`)

* **Purpose:**
  Converts raw RNA-Seq FASTQ data into count matrices required for downstream analysis.

* **Key Steps:**

  * Soft links to raw FASTQ files to avoid duplication on HPC storage.
  * Quality trimming using **scythe** and **sickle** with appropriate base quality offset detection.
  * Alignment of reads to the reference mouse chromosome 2 genome using **HISAT2**, taking into account strandedness of libraries.
  * Conversion and sorting of SAM/BAM files using **samtools**.
  * Transcript assembly and quantification using **stringtie** in non-discovery mode based on provided GTF annotations.
  * Generation of gene and transcript count matrices using **prepDE.py**.
  * Cleanup of intermediate files to optimize disk usage.

* **Execution:**
  This script is intended to be submitted as a single job on the HPC cluster.
  
---

### 2. R Script (`deseq2_analysis.R`)

* **Purpose:**
  Performs comprehensive differential expression analysis on gene and transcript count data generated by the Bash pipeline.

* **Key Steps:**

  * Reads gene and transcript count matrices and experimental design CSV.
  * Constructs DESeq2 datasets (`dds` objects) with filtering of low-count genes.
  * Performs normalization and dispersion estimation.
  * Generates diagnostic plots: dispersion plots, PCA plots (including batch-corrected PCA), and mean-variance plots comparing log and rlog transformations.
  * Extracts differential expression results under multiple hypotheses (LFC = 0 and LFC < 1), including shrunken and unshrunken log fold changes.
  * Produces MA plots illustrating DE results.
  * Applies batch correction using limma on rlog-transformed counts and exports corrected counts.
  * Saves significant gene lists to CSV files for contrasts B vs A and C vs A.

---

##Notes
* The pipeline assumes single-end RNA-Seq data, stranded library preparation, and mouse chromosome 2 reference genome and annotation as per the project specifications.



